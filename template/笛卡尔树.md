# 笛卡尔树

![alt text](image.png)

上面这棵笛卡尔树相当于把数组元素值当作键值 $w$，而把数组下标当作键值 $k$。显然可以发现，这棵树的键值 $k$ 满足二叉搜索树的性质，而键值 $w$ 满足小根堆的性质。

其实图中的笛卡尔树是一种特殊的情况，因为二元组的键值 $k$ 恰好对应数组下标，这种特殊的笛卡尔树有一个性质，就是一棵子树内的下标是连续的一个区间（这样才能满足二叉搜索树的性质）。更一般的情况则是任意二元组构建的笛卡尔树。

**构建：**

```c++
vec<int> a(n + 1);//输入的数组
for(int i = 1; i <= n; ++i) std::cin >> a[i];

vec<int> s(n + 10);//模拟的栈
int top = 0;//栈顶指针
vec<Pii> v(n + 1);//存储每个节点的左右儿子
for(int i = 1; i <= n; ++i) {
    int k = top;
    while(k > 0 and a[s[k]] > a[i]) --k;
    if(k) v[s[k]].second = i;
    if(k < top) v[i].first = s[k + 1];
    s[++k] = i;
    top = k;
}
```