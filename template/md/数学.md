# 费马小定理

**定义：**
若$p$为质数，$gcd(a,p) = 1$，则$a^{p-1} \equiv 1(\mod p)$
另一个形式：对于任意整数$a$ ，有$a^p \equiv a(\mod p)$

# 欧拉定理

**定义：**
若$gcd(a, m)=1$，则$a^{\phi(m)} \equiv 1(\mod m)$

当 $m$ 为素数时，由于 $\varphi(m) = m - 1$，代入欧拉定理可立即得到费马小定理。

# 扩展欧拉定理

**定义：**
![alt text](image.png)

第二行表达的意思是：如果 $b < \varphi(m)$ 的话，就不能降幂了。

主要是因为题目中 $m$ 不会太大，而如果 $b < \varphi(m)$，自然复杂度是可以接受的。而如果 $b \ge \varphi(m)$ 的话，复杂度可能就超出预期了，这个时候我们才需要降幂来降低复杂度。

# 线性同余方程

**定义：**

形如
$$ax \equiv b(\mod n)$$
的方程称为 线性同余方程。其中，$a$、$b$ 和 $n$ 为给定整数，$x$ 为未知数。需要从区间 $[0, n-1]$ 中求解 $x$，当解不唯一时需要求出全体解。

**用逆元求解**

首先考虑简单的情况，当 $a$ 和 $n$ 互素时，即 $\gcd(a, n) = 1$。

此时可以计算 $a$ 的逆元，并将方程的两边乘以 $a$ 的逆元，可以得到唯一解。

对于不互素的情况线性同余方程的 解的数量 等于 $g = \gcd(a, n)$ 或等于 $0$。

**用扩展欧几里得算法求解**

根据以下两个定理，可以求出线性同余方程 $ax\equiv b \pmod n$ 的解。

定理 1：线性同余方程 $ax\equiv b \pmod n$ 可以改写为如下线性不定方程：

$$ ax + nk = b$$

其中 $x$ 和 $k$ 是未知数。这两个方程是等价的，有整数解的充要条件为 $\gcd(a,n) \mid b$。

应用扩展欧几里德算法可以求解该线性不定方程。根据定理1，对于线性不定方程 $ax+nk=b$，可以先用扩展欧几里得算法求出一组 $x_0$,$k_0$，也就是 $ax_0+nk_0=\gcd(a,n)$，然后两边同时除以 $\gcd(a,n)$，再乘 $b$。就得到了方程
// TODO

# 同余方程

**定义：**
对正整数 $m$ 和一元整系数多项式 
$f(x)=\sum_{i=0}^n a_ix^i$，其中未知数 $x\in\mathbf{Z}_m$，称形如

$f(x) \equiv 0 (\mod m)$的方程为关于未知数 $x$ 的模 $m$ 的一元 同余方程。

若 $a_n\not\equiv 0\pmod m$，则称上式为 $n$ 次同余方程。

类似可定义同余方程组。

// TODO

# 康托展开

**定义：**

对于一个$1$到$n$的排列${a_1, a_2,..., a_n}$，字典序比它小的排列的数量有：
$$\sum_{i=1}^{n} sum_{a_i} \times (n - i) !$$

其中$sum_{a_i}$表示在$a_i$后面的元素里比它小的元素个数，即$\sum_{j=i}^{n}(a_j \lt a_i)$

**解释：**
![alt text](image-1.png)

# 狄利克雷卷积

## 定义
对于两个数论函数 f(x) 和 g(x)，则它们的狄利克雷卷积得到的结果 h(x) 定义为：

$$
h(x)=\sum_{d\mid x}{f(d)g\left(\dfrac xd \right)}=\sum_{ab=x}{f(a)g(b)}
$$
上式可以简记为：
$$
h=f*g
$$

## 性质

**交换律：** $f*g=g*f$。

**结合律：** $(f*g)*h=f*(g*h)$。

**分配律：** $(f+g)*h=f*h+g*h$。

**等式的性质：** $f=g 的充要条件是 f*h=g*h，其中数论函数 h(x) 要满足 h(1)\ne 0$。

## 单位元
单位函数 $\varepsilon$ 是 $Dirichlet$ 卷积运算中的单位元，即对于任何数论函数 $f$，都有 $f*\varepsilon=f$。

## 逆元 

对于任何一个满足 $f(x)\ne 0$ 的数论函数，如果有另一个数论函数 $g(x)$ 满足 $f*g=\varepsilon$，则称 $g(x)$ 是 $f(x)$ 的逆元。由 **等式的性质** 可知，逆元是唯一的。

## 结论

> 两个积性函数的 $Dirichlet$ 卷积也是积性函数

> 积性函数的逆元也是积性函数


# 莫比乌斯反演

## 定义

$\mu$ 为莫比乌斯函数，定义为
$$
\mu(n)=
\begin{cases}
1&n=1\\
0&n\text{ 含有平方因子}\\
(-1)^k&k\text{ 为 }n\text{ 的本质不同质因子个数}\\
\end{cases}
$$

## 性质

莫比乌斯函数不仅是积性函数，还有如下性质：

  
$$
\sum_{d\mid n}\mu(d)=
\begin{cases}
1&n=1\\
0&n\neq 1\\
\end{cases}
$$
即 $\sum_{d\mid n}\mu(d)=\varepsilon(n)$，$\mu * 1 =\varepsilon$

## 线性筛求莫比乌斯函数

// TODO

## 莫比乌斯变换

设 $f(n)$,$g(n)$ 为两个数论函数。

**形式一：** 如果有 $f(n)=\sum_{d\mid n}g(d)$，那么有 
 
$$g(n)=\sum_{d\mid n}\mu(d)f(\frac{n}{d})$$

这种形式下，数论函数 $f(n)$ 称为数论函数 $g(n)$ 的莫比乌斯变换，数论函数 $g(n)$ 称为数论函数 $f(n)$ 的莫比乌斯逆变换（反演）。

容易看出，数论函数 $g(n)$ 的莫比乌斯变换，就是将数论函数 $g(n)$ 与常数函数 $1$ 进行狄利克雷卷积。

**形式二：** 如果有 $f(n)=\sum_{n|d}g(d)$，那么有 
 
$$g(n)=\sum_{n|d}\mu(\frac{d}{n})f(d)$$